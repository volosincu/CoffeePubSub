!function(a,b){"function"==typeof define&&define.amd?define(["exports"],function(c){return a.cpubsub=b(a,c),a.cpubsub}):"undefined"!=typeof exports?b(a,exports):a.cpubsub=b(a,{})}(this,function(a,b){var c,d;return d=function(a){return"function"==typeof a},c=function(){var a;return a=100*Math.random(Math.random(99)),a.toString().split(".")[1]},b=function(a){var b,e,f,g,h,i,j;this.id=c,b=Object.create(this),f={},e={},i=function(a){var c,d;return c=a,d={route:function(){var a,d,f,g,h,i;for(i={},h=e[c],a=d=0,g=h.length;d<g;a=++d)f=h[a],void 0!==f&&(0===a?i=f.apply(b,arguments):f.apply(b));return i}}};for(g in a)j=a[g],d(j)?(h=new i(g),b[g]=h.route,e[g]=[j]):b[g]=j;return b.__proto__.attachTo=function(a,b,c){void 0===arguments[2]&&(c=e[a].length++),void 0===e[a][c]||null===e[a][c]?e[a][c]=b:Array.prototype.splice.call(e[a],c,0,b)},b.__proto__.on=function(a,b,c){c?f[a]=b.bind(c):f[a]=b.bind({})},b.__proto__.trigger=function(a,b){var c,d;return d={},arguments.length>0?"[object Array]"===Object.prototype.toString.call(b)?(c={},d=f[a].apply(c,b)):d=f[a].call(c,b):d=f,d},b.__proto__.off=function(a){var b;return b=!1,Object.keys(f).indexOf(a)>-1&&(b=delete f[a]),b},b},{createChannel:function(a){return new b(a)}}});